---
import { Icon } from "astro-icon/components";
import { GitHubStats } from "./GitHubStats";
import { useTranslations, defaultLang, type Lang } from "@/i18n";

interface Props {
  title: string;
  description: string;
  repo: string;
  demo?: string;
  tech: string[];
  category: string;
  lang?: Lang;
}

const { title, description, repo, demo, tech, category, lang = defaultLang } = Astro.props;
const t = useTranslations(lang);

const categoryLabels: Record<string, string> = {
  library: t('projects.library'),
  tool: t('projects.tool'),
  cli: t('projects.cli'),
  web: t('projects.web'),
  other: t('projects.other'),
};
---

<article class="rounded-xl border border-border bg-card p-6 transition-all hover:border-foreground/20 hover:shadow-lg">
  <div class="flex items-start justify-between gap-4">
    <div class="flex-1">
      <div class="flex items-center gap-2 mb-2">
        <span class="inline-flex items-center rounded-md bg-primary/10 px-2 py-1 text-xs font-medium text-primary">
          {categoryLabels[category] || category}
        </span>
      </div>
      <h3 class="text-lg font-semibold">{title}</h3>
      <p class="mt-2 text-sm text-muted-foreground">{description}</p>
    </div>
  </div>

  <div class="mt-4 flex flex-wrap gap-2">
    {tech.map((t) => (
      <span class="inline-flex items-center rounded-md bg-secondary px-2 py-1 text-xs font-medium text-secondary-foreground">
        {t}
      </span>
    ))}
  </div>

  <div class="mt-4">
    <GitHubStats repo={repo} client:visible />
  </div>

  <div class="mt-4 flex items-center gap-3">
    <a
      href={repo}
      target="_blank"
      rel="noopener noreferrer"
      class="inline-flex items-center gap-1.5 text-sm font-medium text-muted-foreground hover:text-foreground transition-colors"
    >
      <Icon name="mdi:github" class="w-4 h-4" />
      {t('projects.code')}
    </a>
    {demo && (
      <a
        href={demo}
        target="_blank"
        rel="noopener noreferrer"
        class="inline-flex items-center gap-1.5 text-sm font-medium text-muted-foreground hover:text-foreground transition-colors"
      >
        <Icon name="mdi:open-in-new" class="w-4 h-4" />
        {t('projects.demo')}
      </a>
    )}
  </div>
</article>
